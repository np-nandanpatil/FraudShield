<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FraudShield Payment Gateway</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #ffffff;
            color: #333333;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: none;
            margin-bottom: 2rem;
        }

        .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            padding: 1.5rem;
        }

        .card-body {
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem 0;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #333333;
        }

        .header p {
            color: #6c757d;
            margin-bottom: 0;
        }

        .security-badges {
            text-align: center;
            margin-bottom: 2rem;
        }

        .security-badge {
            display: inline-block;
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            margin: 0.25rem;
            font-size: 0.875rem;
            color: #6c757d;
        }

        .security-badge i {
            margin-right: 0.5rem;
            color: #28a745;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .payment-method {
            cursor: pointer;
            padding: 1.5rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background-color: #ffffff;
            text-align: center;
            transition: border-color 0.2s;
        }

        .payment-method:hover {
            border-color: #007bff;
        }

        .payment-method.active {
            border-color: #007bff;
            background-color: #f8f9ff;
        }

        .payment-method img {
            height: 40px;
            margin-bottom: 0.5rem;
        }

        .order-summary {
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .order-summary h5 {
            color: #333333;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .saved-cards {
            margin-bottom: 2rem;
        }

        .saved-card {
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #ffffff;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .saved-card:hover {
            border-color: #007bff;
        }

        .form-control {
            border: 1px solid #d0d0d0;
            border-radius: 6px;
            padding: 0.75rem;
            font-size: 1rem;
        }

        .form-control:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.1);
        }

        .form-control.is-invalid {
            border-color: #dc3545;
        }

        .invalid-feedback {
            display: none;
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .btn-primary {
            background-color: #007bff;
            border: none;
            border-radius: 6px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .fraud-detection-info {
            margin-top: 2rem;
            padding: 1.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #f8f9fa;
        }

        .fraud-detection-info h6 {
            color: #6c757d;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .fraud-meter {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .fraud-meter-fill {
            height: 100%;
            background: linear-gradient(to right, #28a745, #ffc107, #dc3545);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 5px;
        }

        .result-card {
            margin-top: 2rem;
            padding: 2rem;
            text-align: center;
            border-radius: 8px;
        }

        .result-card.alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .result-card.alert-danger {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .text-muted {
            color: #6c757d !important;
        }

        .text-success {
            color: #28a745 !important;
        }

        .text-danger {
            color: #dc3545 !important;
        }

        .result-card.alert-info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        @media (max-width: 768px) {
            .payment-methods {
                grid-template-columns: repeat(2, 1fr);
            }

            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>FraudShield Payment Gateway</h1>
            <p>Secure Payments with Real-time Fraud Detection</p>
            <div class="security-badges">
                <span class="security-badge"><i class="fas fa-shield-alt"></i> PCI DSS Compliant</span>
                <span class="security-badge"><i class="fas fa-lock"></i> 256-bit Encryption</span>
                <span class="security-badge"><i class="fas fa-fingerprint"></i> AI Fraud Detection</span>
                <span class="security-badge"><i class="fas fa-check-circle"></i> 3D Secure 2.0</span>
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-header">
                <h4 class="mb-0">Choose Payment Method</h4>
            </div>
            <div class="card-body">
                <div class="payment-methods">
                    <div class="payment-method active" data-method="card">
                        <!-- <img src="https://via.placeholder.com/60x40?text=Card" alt="Credit/Debit Card"> -->
                        <div class="mt-2">Card</div>
                    </div>
                    <div class="payment-method" data-method="upi">
                        <!-- <img src="https://via.placeholder.com/60x40?text=UPI" alt="UPI"> -->
                        <div class="mt-2">UPI</div>
                    </div>
                    <div class="payment-method" data-method="netbanking">
                        <!-- <img src="https://via.placeholder.com/60x40?text=NetBanking" alt="Net Banking"> -->
                        <div class="mt-2">Net Banking</div>
                    </div>
                    <div class="payment-method" data-method="wallet">
                        <!-- <img src="https://via.placeholder.com/60x40?text=Wallet" alt="Wallet"> -->
                        <div class="mt-2">Wallet</div>
                    </div>
                </div>
                
                <div class="order-summary">
                    <h5>Order Summary</h5>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Product:</span>
                        <span>Demo Product</span>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Merchant:</span>
                        <span>FraudShield Demo Store</span>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Order ID:</span>
                        <span>ORD-<script>document.write(Math.floor(Math.random()*900000)+100000)</script></span>
                    </div>
                    <div class="d-flex justify-content-between font-weight-bold">
                        <span class="fw-bold">Amount:</span>
                        <span class="fw-bold amount-display">₹{{ amount }}.00</span>
                    </div>
                </div>
                
                <div id="payment-forms">
                    <!-- Credit/Debit Card Form -->
                    <div id="card-form" class="payment-form">
                        <h5 class="mt-4 mb-3">Credit/Debit Card</h5>

                        <div class="saved-cards">
                            <h6 class="mb-3 text-muted">Saved Cards</h6>
                            <div class="saved-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="far fa-credit-card me-2"></i> XXXX XXXX XXXX 4242</span>
                                    <span>Expires: 12/25</span>
                                </div>
                            </div>
                            <div class="saved-card">
                                <div class="d-flex justify-content-between">
                                    <span><i class="far fa-credit-card me-2"></i> XXXX XXXX XXXX 5678</span>
                                    <span>Expires: 08/24</span>
                                </div>
                            </div>
                        </div>
                        
                        <form id="cardForm">
                            <div class="mb-4">
                                <label for="cardNumber" class="form-label">Card Number:</label>
                                <input type="text" id="cardNumber" class="form-control" required placeholder="XXXX XXXX XXXX XXXX">
                                <div class="invalid-feedback" id="cardNumberError"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="expiry" class="form-label">Expiry Date:</label>
                                        <input type="text" id="expiry" class="form-control" placeholder="MM/YY" required>
                                        <div class="invalid-feedback" id="expiryError"></div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="cvv" class="form-label">CVV:</label>
                                        <input type="text" id="cvv" class="form-control" required placeholder="XXX">
                                        <div class="invalid-feedback" id="cvvError"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label for="cardHolder" class="form-label">Card Holder Name:</label>
                                <input type="text" id="cardHolder" class="form-control" required placeholder="JOHN DOE">
                            </div>
                            <div class="form-check mb-4">
                                <input type="checkbox" id="saveCard" class="form-check-input">
                                <label for="saveCard" class="form-check-label">Save card for future payments</label>
                            </div>
                            <div class="fraud-detection-info">
                                <h6>Fraud Detection Status</h6>
                                <div class="fraud-meter">
                                    <div class="fraud-meter-fill" id="fraud-meter"></div>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <small class="text-success">Low Risk</small>
                                    <small class="text-warning">Medium Risk</small>
                                    <small class="text-danger">High Risk</small>
                                </div>
                                <p class="mt-3 mb-0 text-muted"><small>Our AI is constantly analyzing this transaction for fraud patterns.</small></p>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg w-100 mt-4">Pay ₹{{ amount }}.00</button>
                        </form>
                    </div>
                    
                    <!-- UPI Form -->
                    <div id="upi-form" class="payment-form" style="display: none;">
                        <h5 class="mt-4 mb-3">UPI Payment</h5>
                        <form id="upiForm">
                            <div class="mb-4">
                                <label for="upiId" class="form-label">UPI ID:</label>
                                <input type="text" id="upiId" class="form-control" required placeholder="example@upi">
                                <div class="invalid-feedback" id="upiIdError"></div>
                            </div>
                            <div class="fraud-detection-info">
                                <h6>Fraud Detection Status</h6>
                                <div class="fraud-meter">
                                    <div class="fraud-meter-fill" id="fraud-meter-upi"></div>
                                </div>
                                <div class="d-flex justify-content-between">
                                    <small class="text-success">Low Risk</small>
                                    <small class="text-warning">Medium Risk</small>
                                    <small class="text-danger">High Risk</small>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-lg w-100 mt-4">Pay ₹{{ amount }}.00</button>
                        </form>
                    </div>
                    
                    <!-- Other forms would be defined here -->
                </div>
            </div>
            <div class="card-footer text-center">
                <div class="d-flex justify-content-center align-items-center gap-4 flex-wrap">
                    <div class="security-badge">
                        <i class="fas fa-shield-alt"></i> Secured by FraudShield
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-brain"></i> AI Fraud Detection
                    </div>
                    <div class="security-badge">
                        <i class="fas fa-lock"></i> 256-bit SSL Encryption
                    </div>
                </div>
            </div>
        </div>
        
        <div id="result" class="glass-card result-card mt-4" style="display: none;">
            <h4 id="resultTitle" class="mb-3"></h4>
            <div id="resultDetails"></div>
        </div>
        
        <div class="text-center mt-4">
            <!-- Remove public dashboard link, add developer comment instead -->
            <!-- 
            Admin access only: 
            <a href="/admin" class="btn btn-outline-light">Admin Dashboard</a>
            -->
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function isValidCardNumber(number) {
            // Remove spaces and non-numeric characters
            number = number.replace(/\D/g, '');
            if (number.length !== 16) return false;
            
            // Luhn Algorithm for card number validation
            let sum = 0;
            let shouldDouble = false;
            for (let i = number.length - 1; i >= 0; i--) {
                let digit = parseInt(number.charAt(i));
                if (shouldDouble) {
                    digit *= 2;
                    if (digit > 9) digit -= 9;
                }
                sum += digit;
                shouldDouble = !shouldDouble;
            }
            return sum % 10 === 0;
        }

        function isValidCVV(cvv) {
            return /^\d{3}$/.test(cvv);
        }

        function isValidExpiryDate(expiry) {
            if (!/^\d{2}\/\d{2}$/.test(expiry)) return false;
            
            const [month, year] = expiry.split('/').map(Number);
            if (month < 1 || month > 12) return false;
            
            const now = new Date();
            const currentYear = now.getFullYear() % 100;
            const currentMonth = now.getMonth() + 1;
            
            if (year < currentYear) return false;
            if (year === currentYear && month < currentMonth) return false;
            
            return true;
        }

        function isValidUPIId(upiId) {
            // Simple regex for UPI ID format validation
            return /^[\w.-]+@[\w.-]+$/.test(upiId);
        }

        function showError(inputId, errorId, message) {
            $(`#${inputId}`).addClass('is-invalid');
            $(`#${errorId}`).text(message).show();
        }

        function clearError(inputId, errorId) {
            $(`#${inputId}`).removeClass('is-invalid');
            $(`#${errorId}`).text('').hide();
        }

        function clearAllErrors() {
            $('.is-invalid').removeClass('is-invalid');
            $('.invalid-feedback').text('').hide();
        }

        function getDeviceId() {
            // Simple device ID generation
            if (localStorage.getItem('deviceId')) {
                return localStorage.getItem('deviceId');
            }
            const deviceId = 'Device_' + Math.floor(Math.random() * 9000 + 1000);
            localStorage.setItem('deviceId', deviceId);
            return deviceId;
        }
        
        function getLocation() {
            // Simulated location data
            return '12.9716, 77.5946'; // Default to Bangalore coordinates
        }

        function showResult(data, isError) {
            const resultElement = document.getElementById('result');
            const resultTitle = document.getElementById('resultTitle');
            const resultDetails = document.getElementById('resultDetails');
            
            resultElement.style.display = 'block';
            
            if (isError) {
                resultElement.className = 'glass-card result-card mt-4 alert-danger';
                resultTitle.textContent = 'Transaction Blocked';
                const confidencePercent = (data.confidence && !isNaN(data.confidence)) ? (data.confidence * 100).toFixed(2) + '%' : 'N/A';
                resultDetails.innerHTML = `
                    <div class="mb-3">
                        <i class="fas fa-exclamation-circle fa-3x text-danger mb-3"></i>
                    </div>
                    <p><strong>Reason:</strong> ${data.reason || 'Suspicious activity detected'}</p>
                    <p><strong>Confidence:</strong> ${confidencePercent}</p>
                    <p>Our fraud detection system has flagged this transaction. Please try a different payment method or contact your bank.</p>
                `;
            } else if (data.status === 'pending_verification') {
                resultElement.className = 'glass-card result-card mt-4 alert-info';
                resultTitle.textContent = 'Verification Required';
                resultDetails.innerHTML = `
                    <div class="mb-3">
                        <i class="fas fa-shield-alt fa-3x text-primary mb-3"></i>
                    </div>
                    <p>Your transaction requires additional verification.</p>
                    <p>You will be redirected to the verification page.</p>
                    <div class="text-center mt-4">
                        <a href="${data.redirect_url}" class="btn btn-primary">Proceed to Verification</a>
                    </div>
                `;
            } else {
                resultElement.className = 'glass-card result-card mt-4 alert-success';
                resultTitle.textContent = 'Transaction Approved';
                resultDetails.innerHTML = `
                    <div class="mb-3">
                        <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                    </div>
                    <p><strong>Status:</strong> Payment Successful</p>
                    <p><strong>Confidence:</strong> ${(data.confidence * 100).toFixed(2)}%</p>
                    <p>Your transaction has been processed successfully. Thank you for using our payment gateway!</p>
                `;
            }
            
            // Scroll to result
            resultElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // Simulate real-time fraud detection
        function updateFraudMeter() {
            // For card form
            const cardNumber = $('#cardNumber').val() || '';
            const cvv = $('#cvv').val() || '';
            const expiry = $('#expiry').val() || '';
            
            let riskScore = 0;
            
            // Card number validation
            if (cardNumber.length > 0) {
                if (cardNumber.includes('4242')) riskScore += 10;
                if (cardNumber.length < 16 || cardNumber.length > 19) riskScore += 20;
                if (cardNumber.match(/(\d)\1{5,}/)) riskScore += 30; // Repeated digits
            }
            
            // CVV validation
            if (cvv.length > 0) {
                if (cvv === '123' || cvv === '000') riskScore += 15;
            }
            
            // Expiry validation
            if (expiry.length > 0) {
                const [month, year] = expiry.split('/').map(Number);
                if (year < new Date().getFullYear() % 100) riskScore += 25;
            }
            
            // Amount is also a factor
            if ({{ amount }} > 5000) riskScore += 20;
            
            // Cap the risk score at 100
            riskScore = Math.min(riskScore, 100);
            
            // Update the fraud meter with smooth animation
            $('#fraud-meter').css('width', riskScore + '%');
            
            // Similar logic for UPI
            const upiId = $('#upiId').val() || '';
            let upiRiskScore = 0;
            
            if (upiId.length > 0) {
                if (!upiId.includes('@')) upiRiskScore += 30;
                if (upiId.includes('suspicious')) upiRiskScore += 50;
            }
            
            // Amount is also a factor
            if ({{ amount }} > 5000) upiRiskScore += 20;
            
            // Cap the risk score
            upiRiskScore = Math.min(upiRiskScore, 100);
            
            // Update the UPI fraud meter with smooth animation
            $('#fraud-meter-upi').css('width', upiRiskScore + '%');
        }
        
        $(document).ready(function() {
            // Set initial payment method based on URL parameter
            const paymentMethod = '{{ payment_method }}';
            $('.payment-method').removeClass('active');
            $(`.payment-method[data-method="${paymentMethod.toLowerCase()}"]`).addClass('active');
            
            // Show corresponding form
            $('.payment-form').hide();
            $(`#${paymentMethod.toLowerCase()}-form`).show();
            
            // Set amount
            const amount = {{ amount }};
            $('.amount-display').text('₹' + amount.toFixed(2));
            $('button[type="submit"]').text('Pay ₹' + amount.toFixed(2));
            
            // Store other parameters as data attributes
            $('body').data('merchantType', '{{ merchant_type }}');
            $('body').data('deviceId', '{{ device_id }}');
            $('body').data('location', '{{ location }}');
            
            // Payment method selection
            $('.payment-method').click(function() {
                $('.payment-method').removeClass('active');
                $(this).addClass('active');
                
                const method = $(this).data('method');
                $('.payment-form').hide();
                $('#' + method + '-form').show();
            });
            
            // Fraud meter updates
            $('input').on('input', updateFraudMeter);
            
            // Update initially
            setTimeout(updateFraudMeter, 500);
            
            // Add card number formatting and validation
            $('#cardNumber').on('input', function() {
                clearError('cardNumber', 'cardNumberError');
                let value = $(this).val().replace(/\D/g, '');
                if (value.length > 16) value = value.substr(0, 16);

                // Add spaces after every 4 digits
                let formattedValue = '';
                for(let i = 0; i < value.length; i++) {
                    if(i > 0 && i % 4 === 0) {
                        formattedValue += ' ';
                    }
                    formattedValue += value[i];
                }

                $(this).val(formattedValue);
            });

            // Real-time validation for CVV
            $('#cvv').on('input', function() {
                clearError('cvv', 'cvvError');
            });

            // Real-time validation for UPI
            $('#upiId').on('input', function() {
                clearError('upiId', 'upiIdError');
            });

            // Add expiry date formatting and validation
            $('#expiry').on('input', function() {
                clearError('expiry', 'expiryError');
                let value = $(this).val().replace(/\D/g, '');
                if (value.length > 4) value = value.substr(0, 4);

                if (value.length > 2) {
                    $(this).val(value.substr(0, 2) + '/' + value.substr(2));
                } else {
                    $(this).val(value);
                }
            });
            
            // Card form submission
            $('#cardForm').on('submit', function(event) {
                event.preventDefault();
                clearAllErrors();
                const cardNumber = $('#cardNumber').val().replace(/\s+/g, '');
                const cvv = $('#cvv').val();
                const expiry = $('#expiry').val();
                const cardHolder = $('#cardHolder').val();

                let hasError = false;
                if (!isValidCardNumber(cardNumber)) {
                    showError('cardNumber', 'cardNumberError', 'Invalid card number. Please check and try again.');
                    hasError = true;
                }
                if (!isValidCVV(cvv)) {
                    showError('cvv', 'cvvError', 'Invalid CVV. Must be 3 digits.');
                    hasError = true;
                }
                if (!isValidExpiryDate(expiry)) {
                    showError('expiry', 'expiryError', 'Invalid expiry date. Use MM/YY format and ensure date is in the future.');
                    hasError = true;
                }
                if (hasError) return;

                const data = {
                    Transaction_ID: 'CARD_' + Date.now(),
                    Timestamp: new Date().toISOString(),
                    Amount: {{ amount }},
                    Sender_ID: cardNumber.substring(0, 6) + '******' + cardNumber.substring(12),
                    Receiver_ID: 'FraudShield_Merchant',
                    Transaction_Type: 'Card',
                    Merchant_Type: $('body').data('merchantType'),
                    Device_ID: $('body').data('deviceId'),
                    Location: $('body').data('location'),
                    card_number: cardNumber,
                    cvv: cvv,
                    expiry: expiry
                };
                
                processTransaction(data);
            });
            
            // UPI form submission
            $('#upiForm').on('submit', function(event) {
                event.preventDefault();
                clearAllErrors();
                const upiId = $('#upiId').val();

                if (!isValidUPIId(upiId)) {
                    showError('upiId', 'upiIdError', 'Invalid UPI ID format. Please use format like name@upi');
                    return;
                }
                
                const data = {
                    Transaction_ID: 'UPI_' + Date.now(),
                    Timestamp: new Date().toISOString(),
                    Amount: {{ amount }},
                    Sender_ID: upiId,
                    Receiver_ID: 'FraudShield@upi',
                    Transaction_Type: 'UPI',
                    Merchant_Type: $('body').data('merchantType'),
                    Device_ID: $('body').data('deviceId'),
                    Location: $('body').data('location')
                };
                
                processTransaction(data);
            });
        });

        function processTransaction(data) {
            // Show loading indicator
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').className = 'glass-card result-card mt-4 alert-info';
            document.getElementById('resultTitle').textContent = 'Processing Transaction...';
            document.getElementById('resultDetails').innerHTML = `
                <div class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3">Please wait while we process your payment and analyze for potential fraud...</p>
                </div>
            `;
            
            fetch('/process_transaction', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                const isError = !response.ok;
                return response.json().then(data => ({ data, isError }));
            })
            .then(({ data, isError }) => {
                showResult(data, isError);
            })
            .catch(error => {
                document.getElementById('result').className = 'glass-card result-card mt-4 alert-danger';
                document.getElementById('resultTitle').textContent = 'Error';
                document.getElementById('resultDetails').innerHTML = `<p>An error occurred: ${error.message}</p>`;
            });
        }
    </script>
</body>
</html> 