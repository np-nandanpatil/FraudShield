<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FraudShield Payment Gateway</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #ffffff;
            color: #333333;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 20px;
            margin-top: 1.5rem;
        }

        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .right-panel {
            display: flex;
            flex-direction: column;
        }

        .card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            box-shadow: none;
        }

        .card-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            padding: 1rem;
        }

        .card-body {
            padding: 1rem;
        }

        .card-header h4, .card-header h5 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .header {
            text-align: center;
            margin-bottom: 1rem;
            padding: 0.75rem 0;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: #333333;
        }

        .header p {
            color: #6c757d;
            margin-bottom: 0;
            font-size: 0.9rem;
        }

        .security-badges {
            text-align: center;
            margin-bottom: 0.75rem;
        }

        .security-badge {
            display: inline-block;
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            padding: 0.35rem 0.75rem;
            margin: 0.2rem;
            font-size: 0.75rem;
            color: #6c757d;
        }

        .security-badge i {
            margin-right: 0.3rem;
            color: #28a745;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .payment-method {
            cursor: pointer;
            padding: 0.75rem 0.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            background-color: #ffffff;
            text-align: center;
            transition: border-color 0.2s;
            font-size: 0.85rem;
        }

        .payment-method:hover {
            border-color: #007bff;
        }

        .payment-method.active {
            border-color: #007bff;
            background-color: #f8f9ff;
        }

        .payment-method img {
            height: 30px;
            margin-bottom: 0.3rem;
        }

        .order-summary {
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1rem;
        }

        .order-summary h5 {
            color: #333333;
            font-weight: 600;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .order-summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .saved-cards {
            margin-bottom: 1rem;
            display: none;
        }

        .saved-card {
            padding: 0.75rem;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background-color: #ffffff;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: border-color 0.2s;
            font-size: 0.9rem;
        }

        .saved-card:hover {
            border-color: #007bff;
        }

        .form-control {
            border: 1px solid #d0d0d0;
            border-radius: 6px;
            padding: 0.6rem;
            font-size: 0.95rem;
        }

        .form-control:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.1);
        }

        .form-control.is-invalid {
            border-color: #dc3545;
        }

        .invalid-feedback {
            display: none;
            color: #dc3545;
            font-size: 0.8rem;
            margin-top: 0.2rem;
        }

        .btn-primary {
            background-color: #007bff;
            border: none;
            border-radius: 6px;
            padding: 0.65rem 1.25rem;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-lg {
            padding: 0.75rem 1.5rem !important;
        }

        .btn-sm {
            padding: 0.4rem 0.75rem !important;
            font-size: 0.85rem !important;
        }

        .fraud-detection-info {
            margin-top: 1rem;
            padding: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #f8f9fa;
        }

        .fraud-detection-info h6 {
            color: #6c757d;
            margin-bottom: 0.75rem;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .fraud-meter {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .fraud-meter-fill {
            height: 100%;
            background: linear-gradient(to right, #28a745, #ffc107, #dc3545);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 5px;
        }

        .result-card {
            margin-top: 2rem;
            padding: 1.25rem;
            text-align: center;
            border-radius: 8px;
        }

        .result-card h4 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .result-card p {
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
        }

        .result-card i {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .result-card.alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .result-card.alert-danger {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .text-muted {
            color: #6c757d !important;
        }

        .text-success {
            color: #28a745 !important;
        }

        .text-danger {
            color: #dc3545 !important;
        }

        .result-card.alert-info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .form-group-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .form-label {
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
        }

        .mb-3 {
            margin-bottom: 0.75rem;
        }

        .mb-4 {
            margin-bottom: 0.75rem;
        }

        .form-check {
            font-size: 0.9rem;
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .payment-methods {
                grid-template-columns: repeat(2, 1fr);
            }

            .header h1 {
                font-size: 1.3rem;
            }

            .main-layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>FraudShield Payment Gateway</h1>
            <p>Secure Payments with Real-time Fraud Detection</p>
            <div class="security-badges">
                <span class="security-badge"><i class="fas fa-shield-alt"></i> PCI DSS</span>
                <span class="security-badge"><i class="fas fa-lock"></i> 256-bit SSL</span>
                <span class="security-badge"><i class="fas fa-fingerprint"></i> AI Detection</span>
                <span class="security-badge"><i class="fas fa-check-circle"></i> 3D Secure</span>
            </div>
        </div>

        <div class="main-layout">
            <!-- LEFT COLUMN: Order Summary & Results -->
            <div class="left-panel">
                <div class="card">
                    <div class="card-header">
                        <h5>Order Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="order-summary-item">
                            <span>Product:</span>
                            <span>Demo Product</span>
                        </div>
                        <div class="order-summary-item">
                            <span>Merchant:</span>
                            <span>FraudShield Store</span>
                        </div>
                        <div class="order-summary-item">
                            <span>Order ID:</span>
                            <span>ORD-<script>document.write(Math.floor(Math.random()*900000)+100000)</script></span>
                        </div>
                        <div class="order-summary-item" style="font-weight: 600; font-size: 1rem; border-top: 1px solid #e0e0e0; padding-top: 0.75rem; margin-top: 0.75rem;">
                            <span>Amount:</span>
                            <span class="amount-display">‚Çπ{{ amount }}.00</span>
                        </div>
                    </div>
                </div>

                <div id="result" class="result-card" style="display: none;"></div>
            </div>

            <!-- RIGHT COLUMN: Payment Methods & Forms -->
            <div class="right-panel">
                <div class="card">
                    <div class="card-header">
                        <h5>Payment Method</h5>
                    </div>
                    <div class="card-body">
                        <div class="payment-methods">
                            <div class="payment-method active" data-method="card">
                                <div>Card</div>
                            </div>
                            <div class="payment-method" data-method="upi">
                                <div>UPI</div>
                            </div>
                            <div class="payment-method" data-method="netbanking">
                                <div>Net Bank</div>
                            </div>
                            <div class="payment-method" data-method="wallet">
                                <div>Wallet</div>
                            </div>
                        </div>

                        <div id="payment-forms">
                            <!-- Credit/Debit Card Form -->
                            <div id="card-form" class="payment-form">
                                <h5 class="mt-3 mb-3">Card Details</h5>
                                <form id="cardForm">
                                    <div class="mb-3">
                                        <label for="cardNumber" class="form-label">Card Number</label>
                                        <input type="text" id="cardNumber" class="form-control" required placeholder="XXXX XXXX XXXX XXXX">
                                        <div class="invalid-feedback" id="cardNumberError"></div>
                                    </div>
                                    <div class="form-group-row">
                                        <div>
                                            <label for="expiry" class="form-label">Expiry</label>
                                            <input type="text" id="expiry" class="form-control" placeholder="MM/YY" required>
                                            <div class="invalid-feedback" id="expiryError"></div>
                                        </div>
                                        <div>
                                            <label for="cvv" class="form-label">CVV</label>
                                            <input type="text" id="cvv" class="form-control" required placeholder="XXX">
                                            <div class="invalid-feedback" id="cvvError"></div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="cardHolder" class="form-label">Card Holder Name</label>
                                        <input type="text" id="cardHolder" class="form-control" required placeholder="JOHN DOE">
                                    </div>
                                    <div class="fraud-detection-info">
                                        <h6>Fraud Detection</h6>
                                        <div class="fraud-meter">
                                            <div class="fraud-meter-fill" id="fraud-meter"></div>
                                        </div>
                                        <div class="d-flex justify-content-between" style="font-size: 0.8rem;">
                                            <small class="text-success">Low</small>
                                            <small class="text-warning">Medium</small>
                                            <small class="text-danger">High</small>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 mt-3">Pay ‚Çπ{{ amount }}.00</button>
                                </form>
                            </div>
                            
                            <!-- UPI Form -->
                            <div id="upi-form" class="payment-form" style="display: none;">
                                <h5 class="mt-3 mb-3">UPI Details</h5>
                                <form id="upiForm">
                                    <div class="mb-3">
                                        <label for="upiId" class="form-label">UPI ID</label>
                                        <input type="text" id="upiId" class="form-control" required placeholder="example@upi">
                                        <div class="invalid-feedback" id="upiIdError"></div>
                                    </div>
                                    <div class="fraud-detection-info">
                                        <h6>Fraud Detection</h6>
                                        <div class="fraud-meter">
                                            <div class="fraud-meter-fill" id="fraud-meter-upi"></div>
                                        </div>
                                        <div class="d-flex justify-content-between" style="font-size: 0.8rem;">
                                            <small class="text-success">Low</small>
                                            <small class="text-warning">Medium</small>
                                            <small class="text-danger">High</small>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100 mt-3">Pay ‚Çπ{{ amount }}.00</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function isValidCardNumber(number) {
            // Remove spaces and non-numeric characters
            number = number.replace(/\D/g, '');
            if (number.length !== 16) return false;
            
            // Luhn Algorithm for card number validation
            let sum = 0;
            let shouldDouble = false;
            for (let i = number.length - 1; i >= 0; i--) {
                let digit = parseInt(number.charAt(i));
                if (shouldDouble) {
                    digit *= 2;
                    if (digit > 9) digit -= 9;
                }
                sum += digit;
                shouldDouble = !shouldDouble;
            }
            return sum % 10 === 0;
        }

        function isValidCVV(cvv) {
            return /^\d{3}$/.test(cvv);
        }

        function isValidExpiryDate(expiry) {
            if (!/^\d{2}\/\d{2}$/.test(expiry)) return false;
            
            const [month, year] = expiry.split('/').map(Number);
            if (month < 1 || month > 12) return false;
            
            const now = new Date();
            const currentYear = now.getFullYear() % 100;
            const currentMonth = now.getMonth() + 1;
            
            if (year < currentYear) return false;
            if (year === currentYear && month < currentMonth) return false;
            
            return true;
        }

        function isValidUPIId(upiId) {
            // Simple regex for UPI ID format validation
            return /^[\w.-]+@[\w.-]+$/.test(upiId);
        }

        function showError(inputId, errorId, message) {
            $(`#${inputId}`).addClass('is-invalid');
            $(`#${errorId}`).text(message).show();
        }

        function clearError(inputId, errorId) {
            $(`#${inputId}`).removeClass('is-invalid');
            $(`#${errorId}`).text('').hide();
        }

        function clearAllErrors() {
            $('.is-invalid').removeClass('is-invalid');
            $('.invalid-feedback').text('').hide();
        }

        function getDeviceId() {
            // Simple device ID generation
            if (localStorage.getItem('deviceId')) {
                return localStorage.getItem('deviceId');
            }
            const deviceId = 'Device_' + Math.floor(Math.random() * 9000 + 1000);
            localStorage.setItem('deviceId', deviceId);
            return deviceId;
        }
        
        function getLocation() {
            // Simulated location data
            return '12.9716, 77.5946'; // Default to Bangalore coordinates
        }

        function getFraudTypeDescription(fraudType) {
            const descriptions = {
                'Phishing Link': 'Detected phishing attempt with suspicious link',
                'QR Code Scam': 'Suspicious QR code used for payment',
                'SIM Swap': 'Transaction detected from unusual location/device',
                'Fake UPI App': 'Potential fraudulent app installation detected',
                'Small Testing': 'Multiple small transactions detected',
                'Unusual Location': 'Transaction from unexpected location',
                'Card Skimming': 'Card data may be compromised',
                'Data Breach Reuse': 'Card information linked to known data breach',
                'CNP Fraud': 'Card-not-present fraud detected',
                'Suspicious Card Transaction': 'Unusual card transaction pattern',
                'Suspicious UPI Transaction': 'Unusual UPI transaction pattern'
            };
            return descriptions[fraudType] || fraudType;
        }

        function showResult(data, isError) {
            const resultElement = document.getElementById('result');

            resultElement.style.display = 'block';

            console.log('showResult called with:', { data, isError });

            if (isError) {
                resultElement.className = 'result-card alert-danger';
                const confidencePercent = (data.confidence && !isNaN(data.confidence)) ? (data.confidence * 100).toFixed(1) : 'N/A';
                const fraudDescription = getFraudTypeDescription(data.reason);
                console.log('Confidence calculation:', { confidence: data.confidence, confidencePercent, isNaN: isNaN(data.confidence) });
                resultElement.innerHTML = `
                    <h5 class="mb-3">‚ö†Ô∏è Transaction Blocked</h5>
                    <p class="mb-2"><strong>Reason:</strong></p>
                    <p class="mb-3" style="font-size: 0.95rem;">${fraudDescription}</p>
                    <p class="mb-3"><strong>Confidence Level:</strong> ${confidencePercent}%</p>
                    <p class="text-muted" style="font-size: 0.85rem;">Please try a different payment method or contact your bank.</p>
                `;
            } else if (data.status === 'pending_verification') {
                resultElement.className = 'result-card alert-info';
                resultElement.innerHTML = `
                    <h5 class="mb-3">üîí Verification Required</h5>
                    <p class="mb-3">Your transaction requires additional verification.</p>
                    <div class="text-center">
                        <a href="${data.redirect_url}" class="btn btn-primary btn-sm">Proceed to Verification</a>
                    </div>
                `;
            } else {
                resultElement.className = 'result-card alert-success';
                resultElement.innerHTML = `
                    <h5 class="mb-3">‚úì Payment Successful</h5>
                    <p class="text-muted" style="font-size: 0.9rem;">Your transaction has been processed successfully.</p>
                `;
            }
        }
        
        // Simulate real-time fraud detection
        function updateFraudMeter() {
            // For card form
            const cardNumber = $('#cardNumber').val() || '';
            const cvv = $('#cvv').val() || '';
            const expiry = $('#expiry').val() || '';
            
            let riskScore = 0;
            
            // Card number validation
            if (cardNumber.length > 0) {
                if (cardNumber.includes('4242')) riskScore += 10;
                if (cardNumber.length < 16 || cardNumber.length > 19) riskScore += 20;
                if (cardNumber.match(/(\d)\1{5,}/)) riskScore += 30; // Repeated digits
            }
            
            // CVV validation
            if (cvv.length > 0) {
                if (cvv === '123' || cvv === '000') riskScore += 15;
            }
            
            // Expiry validation
            if (expiry.length > 0) {
                const [month, year] = expiry.split('/').map(Number);
                if (year < new Date().getFullYear() % 100) riskScore += 25;
            }
            
            // Amount is also a factor
            if ({{ amount }} > 5000) riskScore += 20;
            
            // Cap the risk score at 100
            riskScore = Math.min(riskScore, 100);
            
            // Update the fraud meter with smooth animation
            $('#fraud-meter').css('width', riskScore + '%');
            
            // Similar logic for UPI
            const upiId = $('#upiId').val() || '';
            let upiRiskScore = 0;
            
            if (upiId.length > 0) {
                if (!upiId.includes('@')) upiRiskScore += 30;
                if (upiId.includes('suspicious')) upiRiskScore += 50;
            }
            
            // Amount is also a factor
            if ({{ amount }} > 5000) upiRiskScore += 20;
            
            // Cap the risk score
            upiRiskScore = Math.min(upiRiskScore, 100);
            
            // Update the UPI fraud meter with smooth animation
            $('#fraud-meter-upi').css('width', upiRiskScore + '%');
        }
        
        $(document).ready(function() {
            // Set initial payment method based on URL parameter
            const paymentMethod = '{{ payment_method }}';
            $('.payment-method').removeClass('active');
            $(`.payment-method[data-method="${paymentMethod.toLowerCase()}"]`).addClass('active');
            
            // Show corresponding form
            $('.payment-form').hide();
            $(`#${paymentMethod.toLowerCase()}-form`).show();
            
            // Set amount
            const amount = {{ amount }};
            $('.amount-display').text('‚Çπ' + amount.toFixed(2));
            $('button[type="submit"]').text('Pay ‚Çπ' + amount.toFixed(2));
            
            // Store other parameters as data attributes
            $('body').data('merchantType', '{{ merchant_type }}');
            $('body').data('deviceId', '{{ device_id }}');
            $('body').data('location', '{{ location }}');
            
            // Payment method selection
            $('.payment-method').click(function() {
                $('.payment-method').removeClass('active');
                $(this).addClass('active');
                
                const method = $(this).data('method');
                $('.payment-form').hide();
                $('#' + method + '-form').show();
            });
            
            // Fraud meter updates
            $('input').on('input', updateFraudMeter);
            
            // Update initially
            setTimeout(updateFraudMeter, 500);
            
            // Add card number formatting and validation
            $('#cardNumber').on('input', function() {
                clearError('cardNumber', 'cardNumberError');
                let value = $(this).val().replace(/\D/g, '');
                if (value.length > 16) value = value.substr(0, 16);

                // Add spaces after every 4 digits
                let formattedValue = '';
                for(let i = 0; i < value.length; i++) {
                    if(i > 0 && i % 4 === 0) {
                        formattedValue += ' ';
                    }
                    formattedValue += value[i];
                }

                $(this).val(formattedValue);
            });

            // Real-time validation for CVV
            $('#cvv').on('input', function() {
                clearError('cvv', 'cvvError');
            });

            // Real-time validation for UPI
            $('#upiId').on('input', function() {
                clearError('upiId', 'upiIdError');
            });

            // Add expiry date formatting and validation
            $('#expiry').on('input', function() {
                clearError('expiry', 'expiryError');
                let value = $(this).val().replace(/\D/g, '');
                if (value.length > 4) value = value.substr(0, 4);

                if (value.length > 2) {
                    $(this).val(value.substr(0, 2) + '/' + value.substr(2));
                } else {
                    $(this).val(value);
                }
            });
            
            // Card form submission
            $('#cardForm').on('submit', function(event) {
                event.preventDefault();
                clearAllErrors();
                const cardNumber = $('#cardNumber').val().replace(/\s+/g, '');
                const cvv = $('#cvv').val();
                const expiry = $('#expiry').val();
                const cardHolder = $('#cardHolder').val();

                let hasError = false;
                if (!isValidCardNumber(cardNumber)) {
                    showError('cardNumber', 'cardNumberError', 'Invalid card number. Please check and try again.');
                    hasError = true;
                }
                if (!isValidCVV(cvv)) {
                    showError('cvv', 'cvvError', 'Invalid CVV. Must be 3 digits.');
                    hasError = true;
                }
                if (!isValidExpiryDate(expiry)) {
                    showError('expiry', 'expiryError', 'Invalid expiry date. Use MM/YY format and ensure date is in the future.');
                    hasError = true;
                }
                if (hasError) return;

                const data = {
                    Transaction_ID: 'CARD_' + Date.now(),
                    Timestamp: new Date().toISOString(),
                    Amount: {{ amount }},
                    Sender_ID: cardNumber.substring(0, 6) + '******' + cardNumber.substring(12),
                    Receiver_ID: 'FraudShield_Merchant',
                    Transaction_Type: 'Card',
                    Merchant_Type: $('body').data('merchantType'),
                    Device_ID: $('body').data('deviceId'),
                    Location: $('body').data('location'),
                    card_number: cardNumber,
                    cvv: cvv,
                    expiry: expiry
                };
                
                processTransaction(data);
            });
            
            // UPI form submission
            $('#upiForm').on('submit', function(event) {
                event.preventDefault();
                clearAllErrors();
                const upiId = $('#upiId').val();

                if (!isValidUPIId(upiId)) {
                    showError('upiId', 'upiIdError', 'Invalid UPI ID format. Please use format like name@upi');
                    return;
                }
                
                const data = {
                    Transaction_ID: 'UPI_' + Date.now(),
                    Timestamp: new Date().toISOString(),
                    Amount: {{ amount }},
                    Sender_ID: upiId,
                    Receiver_ID: 'FraudShield@upi',
                    Transaction_Type: 'UPI',
                    Merchant_Type: $('body').data('merchantType'),
                    Device_ID: $('body').data('deviceId'),
                    Location: $('body').data('location')
                };
                
                processTransaction(data);
            });
        });

        function processTransaction(data) {
            const resultElement = document.getElementById('result');
            resultElement.style.display = 'block';
            resultElement.className = 'result-card alert-info';
            resultElement.innerHTML = `
                <div class="text-center">
                    <div class="spinner-border spinner-border-sm text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2" style="font-size: 0.9rem;">Processing your payment...</p>
                </div>
            `;
            
            fetch('/process_transaction', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                const isError = !response.ok;
                return response.json().then(data => ({ data, isError }));
            })
            .then(({ data, isError }) => {
                showResult(data, isError);
            })
            .catch(error => {
                const resultElement = document.getElementById('result');
                resultElement.className = 'result-card alert-danger';
                resultElement.innerHTML = `<p>Error: ${error.message}</p>`;
            });
        }
    </script>
</body>
</html> 